{% extends 'form_div_layout.html.twig' %}

{# Labels #}

{% block form_label %}
{% set label_attr = label_attr|merge({'class': 'control-label'}) %}
{{ parent() }}
{% endblock form_label %}

{# Fields #}

{% block date_widget %}
    {% spaceless %}
        {% if widget == 'choice' or widget == 'single_text' or widget == 'text' %}
            {{ parent() }}
        {% else %}
            {% set attr = attr|merge({'class': (attr.class|default('') ~ ' bootstrapp-datetime')|trim}) %}
            <div class="input-prepend inline date" data-widget="{{ widget }}" data-type='date' style="position:relative;">
                <span class="add-on"><i class="icon-calendar"></i></span>
                {{ block('form_widget_simple') }}
                <input type="text" class="{{ widget }}" style="position:absolute; top:0; right: 0; visibility: hidden;"/>
            </div>
        {% endif %}
    {% endspaceless %}
{% endblock date_widget %}

{% block time_widget %}
    {% spaceless %}
        {% if widget == 'choice' or widget == 'single_text' or widget == 'text' %}
            {{ parent() }}
        {% else %}
            {% set attr = attr|merge({'class': (attr.class|default('') ~ ' input-small bootstrapp-datetime')|trim}) %}
            <div class="input-prepend inline time" data-widget="{{ widget }}" data-type='time' style="position:relative;">
                <span class="add-on"><i class="icon-time"></i></span>
                {{ block('form_widget_simple') }}
                <input type="text" class="{{ widget }} input-small" style="position:absolute; top:0; right: 0; visibility: hidden;"/>
            </div>
        {% endif %}
    {% endspaceless %}
{% endblock time_widget %}

{% block datetime_widget %}
    {% spaceless %}
        {% if widget == 'mobiscroll' %}
            {% set attr = attr|merge({'data-widget': widget, 'data-type':'datetime', 'style': 'position:relative;'}) %}
            <div {{ block('widget_container_attributes') }}>
                {{ form_errors(form.date) }}
                {{ form_errors(form.time) }}
                {{ form_widget(form.date) }}
                {{ form_widget(form.time) }}
                <input type="text" class="{{ widget }}" style="position:absolute; top:0; visibility: hidden;"/>
            </div>
        {% else %}
            {{ parent() }}
        {% endif %}
    {% endspaceless %}
{% endblock datetime_widget %}

{# Errors #}

{% block form_errors %}
{% spaceless %}
    {% if errors|length > 0 %}
    <span class="help-inline">
        {% for error in errors %}
        <p>{{
            error.messagePluralization is null
                ? error.messageTemplate|trans(error.messageParameters, 'validators')
                : error.messageTemplate|transchoice(error.messagePluralization, error.messageParameters, 'validators')
        }}</p>
        {% endfor %}
    </span>
    {% endif %}
{% endspaceless %}
{% endblock form_errors %}

{# Rows #}

{% block form_row %}
{% spaceless %}
    {% if form.children|length %}
        {{ form_widget(form) }}
    {% else %}
        <div class="control-group{% if errors %} error{% endif %}">
            {{ form_label(form) }}
            <div class="controls">
                {{ form_widget(form) }}
                {% if parent is defined %}
                    {{ form_errors(parent) }}
                {% else %}
                    {{ form_errors(form) }}
                {% endif %}
            </div>
        </div>
    {% endif %}
{% endspaceless %}
{% endblock form_row %}

{% block form_rows %}
{% spaceless %}
    {% import 'BootstrappBundle:Macro:alert.html.twig' as alert %}
    {% if errors %}
        {% for error in errors %}
            {{ alert.message('error',
                error.messagePluralization is null
                ? error.messageTemplate|trans(error.messageParameters, 'validators')
                : error.messageTemplate|transchoice(error.messagePluralization, error.messageParameters, 'validators')
            ) }}
        {% endfor %}
    {% endif %}
    {% for child in form %}
        {{ form_row(child) }}
    {% endfor %}
{% endspaceless %}
{% endblock form_rows %}